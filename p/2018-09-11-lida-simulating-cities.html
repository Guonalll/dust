<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <meta name="author" content="Nick Malleson">
        <meta name="keywords" content="ABM, dynamic data assimilation, probabilistic programming">

		<title>Simulating cities with streaming (big?) data and agent-based modelling</title>

		<link rel="stylesheet" href="reveal/css/reveal.css">
		<link rel="stylesheet" href="reveal/css/theme/white.css">
        
        <!-- Some extra bits added by Nick -->
        <link rel="stylesheet" href="reveal/css/nick.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal/lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'reveal/css/print/pdf.css' : 'reveal/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                
                <!--
                <section data-markdown id="index"
                         data-background-image="http://surf.leeds.ac.uk/figures/cityscapes/chicago_bw.jpg">
                -->
                    
                <section class="title"  id="index" data-background-image="../figures/shutterstock_615414464-small.jpg">
                    
                    <div class="whitebackground2">XX
                    
                    <h1 style="font-size: 45px;">Simulating cities with streaming (big?) data and agent-based modelling</h1>
                    <hr/>
                    <h2 style="font-size: 35px;"><a href="http://www.geog.leeds.ac.uk/people/n.malleson/">Nick Malleson</a></h2>
                    <h2 style="font-size: 35px;">Jonathan A. Ward, Alison Heppenstall, Michael Adcock, Daniel Tang, Jonathan Coello, Tomas Crols and Minh Kieu</h2>
                    <h4>Leeds Institute for Data Analytics (University of Leeds), Improbable
                        and the Alan Turing Institute</h4>
                    <h4><a href="http://dust.leeds.ac.uk">dust.leeds.ac.uk</a></h4>
                    <hr/>
                    <p style="text-align:center;font-size:25px">These slides and abstract: <a href="https://urban-analytics.github.io/dust/presentations.html">https://urban-analytics.github.io/dust/presentations.html</a></p>
                    </div>
                </section>

   
                
                
                <!-- ************************************************************
                *********************** VISION **********************************
                ************************************************************ -->

                <section data-background-video="../videos/trafalgar_timelapse-1280×720.mp4"
                         data-background-video-loop="loop"
                         id="Context-UrbanFlows">                     
                    <div class="whitebackground2 fragment">
                        <h3>How many people are there in the city centreTrafalgar Square right now?</h3>
                        
                        <p>We need to better understand urban flows:</p>
                        
                        <p class="l2">Crime – how many possible victims?</p>
                        <p class="l2">Pollution – who is being exposed? Where are the hotspots?</p>
                        <p class="l2">Economy – can we attract more people to our city centre?</p>
                        <p class="l2">Health – can we encourage more active travel?</p>
                        
                        <p class="fragment">More broadly: <strong>Understanding urban dynamics</strong></p>
                        
                    </div>
                </section>
                
                <section id="CitySimulation" data-background-video="../videos/skylines_mov-long.mp4"
                         data-background-video-loop="loop">
                    <div class="whitebackground2 fragment">
                        <h3>City Simulation</h3>
                        <p>Making use of diverse (real time) data streams to</p>
                        <p>Understand <i>and predict</i> short-term urban flows</p>
                    </div>
                    
                </section>
                
                <!-- ************************************************************
                *********************** ABM ************************************
                ************************************************************ -->
                
                <section id="IntroToABM4" >

                    <img class="right" style="width:40%" data-src="../figures/sims.png"
                     alt="Diagram of the sims" />
                    <h2>Our approach: Agent-Based Modelling</h2>
                    <p>Systems are driven by individuals</p>
                    <p class="l2">(cars, people, ants, trees, whatever)</p>
                    <p>Bottom-up modelling</p>
                    <p class="l2">Try to represent the individuals</p>
                    <p class="l2">Account for system behaviour directly</p>
                    <p>Autonomous, interacting agents</p>
                    <p>Represent individuals or groups</p>
                    <p>Situated in a virtual environment</p>
                    
                </section>   
                
                <!-- ************************************************************
                *********************** PROBLEM - Divergence ********************
                ************************************************************ -->

                           
                <section data-background-image="../figures/shutterstock_788457058-small.jpg">                     
                    <div class="whitebackground2">
                        <h3>Using Agent-Based Modelling to Simulate Cities</h3>
                        <p>Implement virtual 'people' (agents)</p>
                        <p>Incorporate diverse data (census, loyalty cards, public transport,
                        social media, etc.).</p>
                        <p>Try to simulate the real world</p>                     
                    </div>
                </section>
                

                
                <section id="prob-uncertainty" >
                    <h2>Problem (I): Uncertainty</h2>
                    <p>With agent-based modelling, uncertainty can creep in from many places:</p>
                    <p class="l2">Fundamental model specification (e.g. behavioural theories)</p>
                    <p class="l2">Model parameters</p>
                    <p class="l2">Input data</p>
                    <p>We could use mdoel <i>ensembles</i> to try to better understand uncertainty
                    in agent-based models.</p>
                    
                    <figure>
                        <img src="../figures/ensemble_uncertainty.png" alt="Uncertainty in weather models">
                        <figcaption>Ensembles help to quantify the uncertainty of weather forecasts. 
                            Adapted from Kalnay (2013).</figcaption>
                    </figure>
                    
                    
                </section>
                
                
                <section id="prob-computation">
                    <h2>Problem (II): Computation</h2>
                    <figure class="right">
                        <img src="../figures/Network server room_87108880.jpg" alt="A server room" />
                    </figure>
                    
                    <p>Agent-based models are extremely computationally intensive</p>
                    <p class="l2">Especially large-scale urban models</p>
                    <p><i>Surrogate models</i> (aka 'emulators') could replace the full model in some instances
                    (e.g. as part of a larger ensemble).</p>
                    
                </section>
                
                   <section id="prob-divergence" 
                         data-background-video="../videos/BBC_Swarm_Natures_Incredible_Invasions.mp4" 
                         data-background-video-muted 
                         data-background-video-loop="loop">
                    
                    <div class="whitebackground fragment">
                        <h2>Problem (III): Models diverge from reality</h2>
                        <p>Cities are complex</p>
                        <p>Human behaviour is difficult to predict</p>
                        <p>A model will quickly diverge from reality</p>
                        <p>We need a way to <i>assimilate</i> up to date data into models...</p>
                    </div>
                </section>
                
                
                <section id="dda" data-background-image="../figures/weather2.jpg" >
                    <div class="whitebackground fragment">
                        <h2>Dynamic Data Assimilation</h2>
                        <p>Used in meteorology and hydrology to constrain models closer to reality.</p>
                        <p>Try to improve estimates of the true system state by combining:</p>
                        <p class="l2">Noisy, real-world observations</p>
                        <p class="l2">Model estimates of the system state</p>
                        <p>Should be more accurate than data / observations in isolation.</p>
                    </div>
                </section>
                
                
                <section id="abm-dda-overview">
                    <img data-src="../figures/paper_figures/dda.jpg" alt="Diagram of dynamic data assimilation and an ABM" />
                </section>
                
                
                
                
                
                
                
                <section id="current_research-surf" data-background-image="../figures/cityscapes/chicago_bw.jpg">
                    
                    <div class="whitebackground2">
                        <h2>Current Research</h2>
                        <a href="https://esrc.ukri.org/">
                            <img class="right" style="width:200px;" data-src="../figures/LOGO_ESRC.jpg" alt="ESRC Logo"/></a>

                        <h3>Simulating Urban Flows (<a href="http://surf.leeds.ac.uk">surf</a>)</h3>       
                        <p>3 year research project funded by the UK ESRC</p>
                        <p>Modelling a small town, using real footfall counters</p>
                        <p>Ultimately stream real-time data into the model dynamically</p>
                    </div>
                </section>
                
                                
                <section id="surf-model-otley-environment">
                    
                    <h2>Modelling Footfall</h2>
                    <p>Wi-Fi footfall counters (CDRC). Case study: Otley, West Yorkshire</p>
                    
                    <img class="left" data-src="../figures/surf-model/otley_environment1.png" 
                         alt="The surf model environment in Otley" />
                    
                    <img class="right" data-src="../figures/surf-model/otley_environment2.png" 
                         alt="The surf model environment in Otley (zoom in)" />
                
                </section>
                
                
                <section id="surf-model-otley-video">
                    
                    <h2>Modelling Footfall</h2>
                    
                    <video autoplay>
                        <source src="movie.mp4" type="video/mp4">
                        <source src="movie.ogg" type="video/ogg">
                        Your browser does not support the video tag.
                    </video> 
                
                </section>
                
                
                <section id="surf-model-otley-results">
                    
                    <h2>Modelling Footfall</h2>
                    
                    <img data-src="../figures/surf-model/surf-otley_model-aag_results.png" 
                         alt="Graphs of the model results compared to real data" />
                
                </section>
                
                
                
                
                <!-- ************************************************************
                ****************************** DUST *****************************
                ************************************************************ -->
                
                <section id="dust-intro" data-background-image="../figures/the-roaming-platypus-310824-unsplash-small.jpg">
                    <div class="whitebackground2">
                        <h2>Data Assimilation for Agent-Based Models (DUST)</h2>
                        <a href="https://erc.europa.eu/">
                            <img class="right" style="width:200px;" data-src="../figures/erc_logo.jpg" alt="ESRC Logo"/></a>
                        <p><a href="http://dust.leeds.ac.uk">dust.leeds.ac.uk</a></p>
                        <p>5-year research project (&euro;1.5M)</p>
                        <p>Funded by the European Research Council (Starting Grant)</p>
                        <p>Started in January</p>
                        <p>Main aim: create new methods for dynamically assimilating data into agent-based models.</p>
                    </div>
                
                </section>
                
                
                
                <!-- ************************************************************
                ***************** CURRENT QUESTION + PROGRESS *******************
                ************************************************************ -->
                
                <section id="TrainStationCrowds">
                    
                    <h2>Current Question:</h2>
                    <h3>How much data are needed to successfully model a (pedestrian) system?</h3>                    
                    <img class="right" style="width:30%;" data-src="../figures/train_station_pedestrian.jpg" alt="people in a train station" />
                    <p>Example: Crowds in a train station</p>
                    <p>We want a real-time model to forecast short-term crowding</p>
                    <p>How much data do we need?</p>
                    <p class="l2">Counts of people entering?</p>
                    <p class="l2">Counts at various points in the concourse (e.g. cameras)</p>
                    <p class="l2">Full traces of all individuals?</p>
                    
                    
                </section>
                
                <section id="StationSim-videos">
                    
                    <p><span style="float:left">No crowding</span> <span style="float:right">With crowding</span></p>
                    
                    <p>&nbsp;</p>
                    
                    <video controls width="49%" height="auto" style="float:left">
                        <source src="../videos/StationSim-Videos/stationsim-no_crowding.mp4" type="video/mp4"/>
                         Your browser does not support the video tag.
                    </video>
                    
                    
                    <video controls width="49%" height="auto" style="float:right">
                        <source src="../videos/StationSim-Videos/stationsim-with_crowding.mp4" type="video/mp4"/>
                         Your browser does not support the video tag.
                    </video>
                    
                </section>
                
                
                <section id="ProbabilisticProgramming">
                    
                    <h2>Probabilistic Modelling</h2>
                    <p>Use probability theory to express all forms of uncertainty</p>
                    <p class="l2">Synonymous with Bayesian modelling</p>
                    <p><i>Probabilistic Programming:</i> "a general framework for expressing probabilistic models as computer programs" (<a href="http://www.nature.com/articles/nature14541">Ghahramani, 2015</a>)</p>
                    <p>By expressing the model probabilistically (i.e. with variables represented as 
                        <i>probability distributions</i>), we can explore the impacts of uncertainty and 
                    (importantly) begin to assimilate data.</p>
                    <p class="l2">(hopefully)</p>
                </section>
                
               <section id="ProbabilisticProgramming2">
                   <h2>Current Progress</h2>
                   <p>Work with a new probabilistic programming library <i>(keanu)</i>.</p>
                   <p>Experiment with different amounts of observation data: how
                    well can the probabilistic model find solutions that fit our 'real world' observations</p>
                   <p>Later:</p>
                   <p class="l2">Include all model parameters in probabilistic model, then work out their mean
                   &nbsp; uncertainty (i.e. calibrate against data)</p>
                   <p class="l2">Other useful Baysean inference tasks, e.g. calculate maximum 
                       a posteriori probability (MAP) (should make for efficient sampling)</p>
                   <p class="l2">Data assimilation</p>
                </section>
                
                <section id="OverallProcess">
                    
                    <h2>Experimental setup</h2>
                    <p>1. Configure the model: only <i>input</i> is a list of random numbers</p>
                    <p class="l2">Every time the model needs a random number, chose the next in this list</p>
                    <p class="l2">Model is stochastic with respect to these numbers</p>
                    <p>2. Choose some random numbers and run the model to generate some hypothetical
                    <i>truth data</i></p>
                    <p class="l2">Pretend that this represents a 'real' train station</p>
                    <p>3. Use the probabilistic model to find solutions that fit the observations</p>
                    <p class="l2">Can we estimate the original random numbers that were input into
                        the model?</p>
                    <p class="l2">How many observations of the 'real' data do we need?</p>

                </section>
                
                <section>
                    <h2>Model Output</h2>
                    <img style="width:80%" src="../figures/paper_figures/ABMUS2018/model_output.png" 
                         alt="Graph of model output: no. agents at each iteration" />
                </section>
                
                
                <section id="ProcedureDiagram">
                    
                    <img data-src="../figures/paper_figures/ABMUS2018/procedure_diagram2.png" 
                         alt="Diagram of the probabilistic modelling process" />
                </section>
                
                
                
                
                
                <!-- ************************************************************
                ************************ RESULTS ***********************
                ************************************************************ -->
                
                <section id="Results:ObsVSNoObs">
                    
                    <h3>Results: Sampling the posterior with and without observations</h3>
                    
                    <img style="width:80%;" data-src="../figures/paper_figures/ABMUS2018/no_obs_vs_obs.png" 
                         alt="Comparing the results with and without constraining to observations"/>
                    
                </section>
                
                <section id="Results:VaryingObs">
                    
                    <h3>Results: Varying the number of observations</h3>
                    
                    <img style="width:80%;" data-src="../figures/paper_figures/ABMUS2018/varying_observations.png" 
                         alt="Comparing the results with and without constraining to observations"/>
                    
                </section>
                
                <section id="Results:VaryingObs2">
                    
                    <h2>Results: Varying the number of observations</h2>
                    <h3>Spread of the samples</h3>
                    
                    <table>
                        
                        <tr>
                            <th>Observation Interval</th>
                            <th>Mean Range</th>
                        </tr>
                        <tr><td>0 (prior)</td><td>254</td></tr>
                        <tr><td>1</td><td>91</td></tr>
                        <tr><td>5</td><td>130</td></tr>
                        <tr><td>10</td><td>136</td></tr>
                        <tr><td>50</td><td>116</td></tr>
                    </table>
                    
                </section>

                
                <section id="NextSteps">
                    
                    <h2>Immediate Next Steps</h2>
                    
                    <p>Explain the relationship between observations and sample spread</p>
                    <p>Experiment with different types of observations, e.g.</p>
                    <p class="l2">Cameras that count the passers-by in a single place</p>
                    <p class="l2">Full traces of all agents</p>
                    <p class="l2"><i>Basically: how much do we need to find solutions that fit the observations</i></p>
                    <p class="l2"></p>
                    <p>Move towards <i>data assimilation</i> (actually adjust the state of the 
                    model while it is running in response to external data).</p>
                    <p></p>
                    <p></p>
                    <p></p>
                    
                </section>
         
                
                <section id="conclusions2" data-background-image="../figures/shutterstock_615414464-small.jpg">
                    <div class="whitebackground2">
                        <h2>Conclusion</h2>
                        <p>Overall aim: data assimilation for agent-based models</p>
                        <p class="l2">We want to be able to simulate cities, assimilating real time
                        'smart city' data as they emerge to reduce uncertainty (and prevent divergence).</p>
                        <p>Current goal: use a new probabilistic programming library to:</p>
                        <p class="l2">Experiment with the amount of data needed to simulate a system</p>
                        <p class="l2">Perform Bayesian inference on an ABM</p>
                        <p class="l2">Implement data assimilation</p>
                    </div>
                </section>
                
                <section id="PhDOpportunities" data-background-image="../figures/shutterstock_788457058-small.jpg">
                    <div class="whitebackground2">
                        <h2>Opportunity: Fully-Funded PhD Scholarship (Leeds, UK)</h2>
                        <p><strong>Agent-Based Modelling of Smart Cities</strong></p>
                        <p>Start: October 2018</p>
                        <p>Fully-funded (fees and stipend) for four years</p>
                        <p>Available to UK/EU applicants</p>
                        <p><a href="https://www.findaphd.com/search/ProjectDetails.aspx?PJID=96795">
                        www.findaphd.com/search/ProjectDetails.aspx?PJID=96795</a></p>
                    </div>
                </section>
                
                
                <section class="title"  id="final" data-background-image="../figures/virtual_city.jpeg">
                    <div class="whitebackground2">
                    
                     <h1 style="font-size: 45px;">Understanding Input Data Requirements and Quantifying Uncertainty for Successfully Modelling 'Smart' Cities</h1>
                    <hr/>
                    <h2 style="font-size: 35px;"><a href="http://www.geog.leeds.ac.uk/people/n.malleson/">Nick Malleson</a>, 
                        Jonathan A. Ward, Alison Heppenstall, Michael Adcock, Daniel Tang, Jonathan Coello, and Tomas Crols</h2>
                    <h4>Schools of Geography &amp; Mathematics, University of Leeds, UK</h4>
                    <h4>Improbable, UK</h4>
                    <h4><a href="http://dust.leeds.ac.uk">dust.leeds.ac.uk</a></h4>
                    <hr/>
                    <p style="text-align:center;font-size:25px">These slides: <a href="https://urban-analytics.github.io/dust/presentations.html">https://urban-analytics.github.io/dust/presentations.html</a></p>
                    </div>
                </section>

                
			</div>
		</div>

		<script src="reveal/lib/js/head.min.js"></script>
		<script src="reveal/js/reveal.js"></script>

		<script>
			// More info https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				history: true,

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: 'reveal/plugin/markdown/marked.js' },
					{ src: 'reveal/plugin/markdown/markdown.js' },
					{ src: 'reveal/plugin/notes/notes.js', async: true },
					{ src: 'reveal/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>

