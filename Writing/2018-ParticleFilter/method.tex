% !TEX root = ParticleFilter.tex
\section{Method\label{Method}}

\begin{itemize}
\item Intro to station sim. Outline simple behaviours (i.e. move forwards, or wiggle). Explain simplicity is to allow understandable tests of PF; aim is something complicated enough to allow emergent, but no more complicated. Point to ODD. 
\item Intro to particle filter
\item Outline of experiments, including criteria to measure `success' of the PF
\end{itemize}

Assumptions:

\begin{itemize}
\item Assume PF knows initial conditions
\end{itemize}

Other things to include: 
\begin{itemize}
\item How to quantify `success'?
\item Difference between PF and methods that dynamically alter the state. E.g.: ``We note that this work is different from the work of dynamically calibrating or modifying the agent-based model based on real time data. In our work, the model is not dynamically changed. Instead, the simulation is dynamically reset to start from initial conditions that are estimated from real time sensor data, and thus the simulation/prediction results are dynamically adjusted in real time'' \citep{wang_data_2015}.
\item Difference between state / parameter estimation and traditional calibration. E.g.: ``Also note that even though this work does not calibrate the agent-based model over time, it is possible to treat some of the model parameters as part of the system state and dynamically estimate (calibrate) those parameters based on real time sensor data.''\citep{wang_data_2015}.

\end{itemize}


\subsection{The Agent-Based Model: StationSim}

XXXX outline stations sim


\subsection{Data Assimilation - Introduction and Definitions}

XXXX Outline how data assimilation method works broadly (e.g. \textit{update} and \textit{predict}) and define general concepts / objects.


\subsection{The Particle Filter}

Here, the \textit{state vector} contains all the information that a transition function needs to iterative the model forward by one step, including all of the agent ($i = \{ 0, 1, \dots, N \} $) parameters ($\overrightarrow{p_i}$) and variables ($\overrightarrow{v_i}$) as well as global model parameters $\overrightarrow{P}$:

\begin{equation}
  S  = \left[ \begin{array}{cccccccc}
\overrightarrow{p_0} & \overrightarrow{v_0} & \overrightarrow{p_1} &  \overrightarrow{v_1} &  \dots &  \overrightarrow{p_N} &  \overrightarrow{v_N} & \overrightarrow{P} 
\end{array} \right]
\end{equation} 

The \textit{observation vector} contains all of the observations made from the `real world' (in this case the pseudo-truth model) that the particle filter uses to predict the current true state, with the addition of some Gaussian noise, $\epsilon$:

\begin{equation}
  O  = \left[ \begin{array}{ccccccc}
x_0 & y_0 & x_1 & y_1 & \dots & x_n & y_n 
\end{array} \right]
\end{equation} 

In this paper, the particle filter is not used to estimate the state of the models variables ($\overrightarrow{v_i}$), not any of the parameters ($\overrightarrow{p_i}$ and \overrightarrow{P}) -- although it is worth noting that parameter estimation is technically feasible and will be experimented with in later iterations of this work. Therefore in the experiments conducted here, all parameters are fixed. Hence a further vector is required to map the observations to the state vector that the particle can actually manipulate. We define the partial state vector $S_\textrm{partial}$ to match the shape of $O$, i.e.:

\begin{equation}
  S_\textrm{partial}  = \left[ \begin{array}{ccccccc}
x_0 & y_0 & x_1 & y_1 & \dots & x_n & y_n 
\end{array} \right]
\end{equation} 

